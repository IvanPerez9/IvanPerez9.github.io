name: Send ND Email
on:
  pull_request:
    types: [closed, labeled]
    branches: [main]

jobs:
  send-email:
    if: |
      github.event.pull_request.merged == true && 
      contains(github.event.pull_request.labels.*.name, 'ND')
    runs-on: ubuntu-latest
    steps:
      - name: Send Email
        uses: dawidd6/action-send-mail@v3
        with:
          server_address: smtp-relay.gmail.com
          server_port: 25
          username: ivan120695@gmail.com
          to: ivan120695@gmail.com
          from: GitHub Actions
          subject: ðŸ“‹ Nueva ND - ${{ github.event.pull_request.title }}
          body: |
            # ðŸ“‹ Nueva Nota de Desarrollo

            ## InformaciÃ³n General
            - **TÃ­tulo:** ${{ github.event.pull_request.title }}
            - **Estado:** âœ… Cerrada y fusionada
            - **Autor:** ${{ github.event.pull_request.user.login }}
            - **Repositorio:** ${{ github.repository }}
            
            ## ðŸ”„ Cambios
            ${{ github.event.pull_request.body }}
            
            ## Enlaces
            - [Ver PR en GitHub](${{ github.event.pull_request.html_url }})
            - [Ver Archivos Modificados](${{ github.event.pull_request.html_url }}/files)
          convert_markdown: true